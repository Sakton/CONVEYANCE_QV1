-- отправитель грузов (shipper)

CREATE SCHEMA IF NOT EXISTS shipper;

CREATE TABLE shipper.shippers (
	shipper_id SERIAL UNIQUE, -- PK
	shipper_name VARCHAR(200)
);

--тестировать
CREATE OR REPLACE FUNCTION shipper.getShipper_id( shipperName VARCHAR ) RETURNS INTEGER AS
$$
DECLARE id INTEGER DEFAULT -1;
	BEGIN
		SELECT shipper_id INTO id FROM shipper.shippers WHERE  shipper_name = shipperName;
		IF ( id = -1 ) THEN
			INSERT INTO shipper.shippers ( shipper_name ) VALUES (shipperName);
			SELECT curval( shipper.shippers.shipper_id ) INTO id;
		END IF;
		RETURN id;
	END;
$$
LANGUAGE plpgsql;

